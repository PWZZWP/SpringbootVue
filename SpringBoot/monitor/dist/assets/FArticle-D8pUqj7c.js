/* empty css               *//* empty css                *//* empty css             *//* empty css                 *//* empty css                  *//* empty css                     *//* empty css               *//* empty css              *//* empty css                     */import{r as u}from"./request-Cq_wt7Fs.js";/* empty css                    */import"./index.esm-Bl7adLvg.js";import{T as P,E as H}from"./index.esm-5A9wepVu.js";/* empty css             */import{r as j,y as q,z as G,c as C,a as m,d as o,w as i,b as g,Y as s,Z as k,B as K,A as Y,J as Z,K as Q,L as W,o as c,g as d,h as _,u as x,U as X,G as ee,_ as te,$ as oe,a0 as le}from"./index-B_OMzdnw.js";const ae={class:"card",style:{"margin-bottom":"8px"}},ie={key:0,class:"card",style:{"margin-top":"8px"}},re={class:"card",style:{"margin-top":"8px","margin-bottom":"20px"}},ne={style:{border:"1px solid #ccc",width:"100%"}},se={class:"dialog-footer"},de=["innerHTML"],pe={class:"dialog-footer"},me="http://localhost:9090",E="default",Se={__name:"FArticle",setup(ue){const e=j({user:JSON.parse(localStorage.getItem("monitor-user")),pageNum:1,pageSize:10,total:1,dataList:[],formVisible:!1,form:{},ids:[],viewVisible:!1,content:null,title:""}),n=()=>{u.get("/article/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,title:e.title}}).then(l=>{console.log(l.data),e.dataList=l.data.list,e.total=l.data.total})};n();const N=l=>{e.content=l,e.viewVisible=!0},b=q(),w={MENU_CONF:{}};w.MENU_CONF.uploadImage={server:me+"/files/wang/upload",fieldName:"file"},G(()=>{const l=b.value;l!=null&&l.destroy()});const h=l=>{b.value=l},S=l=>{e.form.img=l.data},U=()=>{e.title=null,n()},z=()=>{e.formVisible=!0,e.form={}},B=()=>{e.form.id?M():I()},I=()=>{u.post("/article/add",e.form).then(l=>{console.log(l),l.code==="200"?(s.success("操作成功"),n(),e.formVisible=!1):s.error(l.msg)})},M=()=>{u.put("/article/update",e.form).then(l=>{l.code==="200"?(s.success("操作成功"),n(),e.formVisible=!1):s.error(l.msg)})},T=l=>{e.form=JSON.parse(JSON.stringify(l)),e.formVisible=!0},L=l=>{k.confirm("确认删除该文章吗？","提示",{type:"warning"}).then(()=>{u.delete("/article/deleteById/"+l).then(t=>{t.code==="200"?(s.success("操作成功"),n()):s.error(t.msg)})}).catch()},O=l=>{e.ids=l.map(t=>t.id),console.log(e.ids)},$=()=>{if(e.ids.length===0){s.error("请先选择要删除的文章");return}k.confirm("确认删除该文章吗？","提示",{type:"warning"}).then(()=>{u.delete("/article/deleteBatch/",{data:e.ids}).then(l=>{l.code==="200"?(s.success("操作成功"),n()):s.error(l.msg)})}).catch()};return(l,t)=>{const y=K,r=Y,p=X,A=ee,F=Z,D=Q,f=te,J=oe,R=le,V=W;return c(),C("div",null,[m("div",ae,[o(y,{clearable:"","prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=a=>e.title=a),placeholder:"请输入标题查询"},null,8,["modelValue"]),o(r,{type:"primary",onClick:n},{default:i(()=>t[10]||(t[10]=[d("查 询")])),_:1}),o(r,{type:"warning",onClick:U},{default:i(()=>t[11]||(t[11]=[d("重 置")])),_:1})]),e.user.role==="USER"?(c(),C("div",ie,[o(r,{type:"primary",onClick:z},{default:i(()=>t[12]||(t[12]=[d("新 增")])),_:1}),o(r,{type:"warning",onClick:$},{default:i(()=>t[13]||(t[13]=[d("批量删除")])),_:1})])):g("",!0),m("div",re,[o(F,{data:e.dataList,stripe:"",onSelectionChange:O},{default:i(()=>[o(p,{type:"selection",width:"55"}),o(p,{label:"标题",prop:"title","show-overflow-tooltip":""}),e.user.role==="ADMIN"?(c(),_(p,{key:0,label:"发布者Id",prop:"userId"})):g("",!0),e.user.role==="ADMIN"?(c(),_(p,{key:1,label:"角色",prop:"role"})):g("",!0),o(p,{label:"封面"},{default:i(a=>[a.row.img?(c(),_(A,{key:0,src:a.row.img,"preview-src-list":[a.row.img],"preview-teleported":"",style:{width:"50px",height:"50px","border-radius":"50%"}},null,8,["src","preview-src-list"])):g("",!0)]),_:1}),o(p,{label:"内容"},{default:i(a=>[o(r,{type:"primary",onClick:v=>N(a.row.content)},{default:i(()=>t[14]||(t[14]=[d("查看内容")])),_:2},1032,["onClick"])]),_:1}),o(p,{label:"发布时间",prop:"time"}),o(p,{label:"操作",width:"120"},{default:i(a=>[o(r,{onClick:v=>T(a.row),type:"success",icon:"Edit",circle:""},null,8,["onClick"]),o(r,{onClick:v=>L(a.row.id),type:"danger",icon:"Delete",circle:""},null,8,["onClick"])]),_:1})]),_:1},8,["data"])]),m("div",null,[o(D,{onSizeChange:n,onCurrentChange:n,"current-page":e.pageNum,"onUpdate:currentPage":t[1]||(t[1]=a=>e.pageNum=a),"page-size":e.pageSize,"onUpdate:pageSize":t[2]||(t[2]=a=>e.pageSize=a),"page-sizes":[5,10,15,20],background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.total},null,8,["current-page","page-size","total"])]),o(V,{title:"文章信息",modelValue:e.formVisible,"onUpdate:modelValue":t[7]||(t[7]=a=>e.formVisible=a),width:"50%","destroy-on-close":""},{footer:i(()=>[m("div",se,[o(r,{onClick:t[6]||(t[6]=a=>e.formVisible=!1)},{default:i(()=>t[16]||(t[16]=[d("取消")])),_:1}),o(r,{onClick:B,type:"primary"},{default:i(()=>t[17]||(t[17]=[d("保存")])),_:1})])]),default:i(()=>[o(R,{ref:"formRef",model:e.form,"label-width":"80px",style:{"padding-right":"50px"}},{default:i(()=>[o(f,{label:"标题",prop:"title"},{default:i(()=>[o(y,{modelValue:e.form.title,"onUpdate:modelValue":t[3]||(t[3]=a=>e.form.title=a),autocomplete:"off",placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),o(f,{label:"封面"},{default:i(()=>[o(J,{action:"http://localhost:9090/files/upload","list-type":"picture","on-success":S},{default:i(()=>[o(r,{type:"primary"},{default:i(()=>t[15]||(t[15]=[d("上传封面")])),_:1})]),_:1})]),_:1}),o(f,{label:"简介",prop:"description"},{default:i(()=>[o(y,{type:"textarea",rows:3,modelValue:e.form.description,"onUpdate:modelValue":t[4]||(t[4]=a=>e.form.description=a),autocomplete:"off",placeholder:"请输入简介"},null,8,["modelValue"])]),_:1}),o(f,{label:"内容",prop:"content"},{default:i(()=>[m("div",ne,[o(x(P),{style:{"border-bottom":"1px solid #ccc"},editor:b.value,mode:E},null,8,["editor"]),o(x(H),{style:{height:"500px","overflow-y":"hidden"},modelValue:e.form.content,"onUpdate:modelValue":t[5]||(t[5]=a=>e.form.content=a),mode:E,defaultConfig:w,onOnCreated:h},null,8,["modelValue"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),o(V,{title:"内容",modelValue:e.viewVisible,"onUpdate:modelValue":t[9]||(t[9]=a=>e.viewVisible=a),width:"50%","close-on-click-modal":!1,"destroy-on-close":""},{footer:i(()=>[m("span",pe,[o(r,{onClick:t[8]||(t[8]=a=>e.viewVisible=!1)},{default:i(()=>t[18]||(t[18]=[d("关 闭")])),_:1})])]),default:i(()=>[m("div",{class:"editor-content-view",style:{padding:"20px"},innerHTML:e.content},null,8,de)]),_:1},8,["modelValue"])])}}};export{Se as default};
